# rTechManager - Full Production Setup

1. UPGRADE NODE (MANDATORY)
curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -
sudo apt update && sudo apt install -y nodejs
node -v # Should say v22.x.x

2. SYSTEM DEPENDENCIES
sudo apt install -y build-essential libpam0g-dev tightvncserver websockify novnc

3. DIRECTORY & PERMISSIONS
sudo mkdir -p /opt/rtechmanager
sudo chown -R $USER:$USER /opt/rtechmanager
cd /opt/rtechmanager

4. INSTALL & BUILD (THE FIX)
# 1. Clean existing state
rm -rf node_modules package-lock.json dist
# 2. Install all dependencies (now includes Vite)
npm install
# 3. Generate the UI 'dist' folder
npm run build 

5. CONFIGURE VNC
vncpasswd # Set your remote desktop password

6. SERVICE CONFIG
sudo tee /etc/systemd/system/rtechmanager.service > /dev/null <<EOF
[Unit]
Description=rTechManager Automated Server
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/rtechmanager
ExecStart=/usr/bin/node server.js
Restart=on-failure
Environment=NODE_ENV=production

[Install]
WantedBy=multi-user.target
EOF

7. START
sudo systemctl daemon-reload
sudo systemctl enable rtechmanager
sudo systemctl restart rtechmanager

8. DEBUGGING
sudo journalctl -u rtechmanager -n 50 --no-pager
